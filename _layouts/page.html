<!doctype html>
<html>

  {% include html_head.html %}

  <body>
    <header>
      <div id="headerpage">
	<a href='{{ "/" | relative_url }}'>
	  <img alt="logo grande" src='{{ "/assets/brand/logo.svg" | relative_url }}' 
	       id="logogrande" class="headerbox3"/>
	</a>
	<div>
	  <p class="headerbox3">Repubblica Popolare Per Azioni della Gianozia Orientale</p>
	  <p class="headerbox3">&Ouml;stergianotische Aktiendemokratische Republik</p>
	  <nav class="bigviewport">
	    <a href='{{ "/page/HomeUnikant" | relative_url }}'>Università</a>
	    <a href='{{ "/page/StoriaGianozia" | relative_url }}'>Storia</a>
	    <a href='{{ "/page/GeografiaGianozia" | relative_url }}'>Geografia</a>
	    <a href='{{ "/page/LingueGianozia" | relative_url }}'>Lingue</a>
	    <a href='{{ "/page/ArchiviKGBaol" | relative_url }}'>Archivio</a>
	    <a href='{{ "/page/Biblioteca" | relative_url }}'>Biblioteca</a>
	    <a href='{{ "/page/Cucina" | relative_url }}'>Cucina</a>
	  </nav>
	</div>

	<nav class="littleviewport">
	  <a href='#' class="handle"><i class="fa fa-bars"></i></a>
	  <a href='{{ "/page/HomeUnikant" | relative_url }}'>Università</a>
	  <a href='{{ "/page/StoriaGianozia" | relative_url }}'>Storia</a>
	  <a href='{{ "/page/GeografiaGianozia" | relative_url }}'>Geografia</a>
	  <a href='{{ "/page/LingueGianozia" | relative_url }}'>Lingue</a>
	  <a href='{{ "/page/ArchiviKGBaol" | relative_url }}'>Archivio</a>
	  <a href='{{ "/page/Biblioteca" | relative_url }}'>Biblioteca</a>
	  <a href='{{ "/page/Cucina" | relative_url }}'>Cucina</a>
	</nav>

      </div>
    </header>

    <main>

      <h1 class="page">{{ page.title }}</h1>

      {% if page.scheda or page.menus or page.has_toc %}
      <aside>
	
	{% if page.scheda %}
	<table>
	  {% for p in page.scheda %}
	  <tr><th>{{ p.key }}</th><td>{{ p.value }}</td></tr>
	  {% endfor %}
	</table>
	{% endif %}
	
	{% if page.has_toc %}<nav id="pagetoc"></nav>{% endif %}
	
	{% if page.menus %}
	<nav id="pagemenu">
	  {% for m in page.menus %}
	  {% assign dmenu=site.data.menus[m] %}
	  {% for ch in dmenu.children %}
	  {% assign menu=site.data.menus[ch] %}
	  {% include menu.html %}
	  {% endfor %}
	  {% assign menu=dmenu %}
	  {% include menu.html %}
	  {% endfor %}
	</nav>
	{% endif %}
      </aside>
      {% endif %}
      
      <article>

	{{ content }}

	<section class="bibliography">

	  <h1>Riferimenti</h1>
	  
	  <dl>
	    {% for e in page.bibliography %}
	    {% assign bib=site.data.biblioreal[e] %}
	    {% include bibliography.html entries=bib %}
	    {% endfor %}
	  </dl>
	  
	</section>

	<footer>
	  <p>
	    creato da {{ page.created_by }} 
	    il {% include datetime.html date=page.created %}
	  </p>
	  <p>
	    modificato {% if page.created_by != page.modified_by %}da {{ page.modified_by }}{% endif %} 
	    il 
	    {% if page.last_modified %}
	    {% include datetime.html date=page.last_modified %}
	    {% else %}
	    {% include datetime.html date=page.date %}
	    {% endif %}
	  </p>
	</footer>

      </article>
      
    </main>

    {% include footer.html %}

    <script>
      $("nav.littleviewport a").hide();
      $("nav.littleviewport a.handle").show();
      $("nav.littleviewport a.handle").click(function(event){
	  event.preventDefault();
	  $(this).siblings().toggle();
      });

      {% if page.citeall != true %}
      $("section.bibliography h1").hide();
      $("section.bibliography dl dt").hide();
      $("section.bibliography dl dd").hide();
      {% endif %}

      $("blockquote").each(function(){
	  var cite=$(this).attr("cite");
	  if (!cite) return;
	  var cite_t=cite.split(':');
	  if (cite_t.length<2) return;
	  if (cite_t[0]!="bib") return;
	  var last=$(this).children().last();
	  var dt=$('a[name='+cite_t[1]+']').parent();
	  var entry;

	  console.log("x",dt);

	  if (dt.length==0) {
	      entry="[==NOREF==]";
	      $(this).append(' '+entry);
	      return
	  }

	  $("section.bibliography h1").show();
	  dt.show();
	  dt.siblings("dd").first().show();

	  entry=dt.text();
	  if (last.length>0)
	      last.append(' <a href="#'+cite_t[1]+'">'+entry+'</a>');
	  else
	      $(this).append(' <a href="#'+cite_t[1]+'">'+entry+'</a>');
	  
      });

      $("section.bibliography dl").each(function(){
	  var children=$(this).children();
	  var sort_list = Array.prototype.sort.bind(children);

	  sort_list(function ( a, b ) {

	      console.log(a,b);

	      // Cache inner content from the first element (a) and the next sibling (b)
	      var aText = $(a).data("order").toLowerCase();
	      var bText = $(b).data("order").toLowerCase();
	      
	      // Returning -1 will place element `a` before element `b`
	      if ( aText < bText ) {
		  return -1;
	      }

	      // Returning 1 will do the opposite
	      if ( aText > bText ) {
		  return 1;
	      }

	      // Returning 0 leaves them as-is
	      return 0;
	  });

	  $(this).append(children);

      });

    </script>

    

  </body>
</html>
